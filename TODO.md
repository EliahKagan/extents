## TODO

- Put `restrict` on pointer parameters where appropriate.
